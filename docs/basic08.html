<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />
    <meta name="robots" content="noindex,nofollow,noarchive" />

    <script>
      MathJax = {
        chtml: {
          displayAlign: "left",
          displayIndent: "1em",
        },
      };
    </script>

    

    <link rel="icon" href="favicon2.ico" sizes="any" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
      integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=M+PLUS+Rounded+1c"
    />
    <link rel="stylesheet" href="style.css" />

    <title>基礎編8　関数</title>
  </head>

  <body>
    <div class="openbtn"><span></span><span></span><span></span></div>
    <nav id="g-nav">
      <div id="g-nav-list">
        <!-- ---------------------------------------- -->
         <ul>
<li><a href="#もくじ" id="toc-もくじ"><span
class="toc-section-number">1</span> もくじ</a></li>
<li><a href="#関数とは" id="toc-関数とは"><span
class="toc-section-number">2</span> 関数とは</a></li>
<li><a href="#関数と引数" id="toc-関数と引数"><span
class="toc-section-number">3</span> 関数と引数</a></li>
<li><a href="#関数と戻り値" id="toc-関数と戻り値"><span
class="toc-section-number">4</span> 関数と戻り値</a></li>
<li><a href="#ローカル変数とグローバル変数"
id="toc-ローカル変数とグローバル変数"><span
class="toc-section-number">5</span> ローカル変数とグローバル変数</a>
<ul>
<li><a href="#ローカル変数" id="toc-ローカル変数"><span
class="toc-section-number">5.1</span> ローカル変数</a></li>
<li><a href="#グローバル変数" id="toc-グローバル変数"><span
class="toc-section-number">5.2</span> グローバル変数</a></li>
</ul></li>
</ul> 
        <!-- ---------------------------------------- -->
      </div>
    </nav>

    <header class="markdown-body">
      <p>Pythonで釣りゲームを作ろう 基礎編8　関数</p>
      <p>2024年04月23日（月)</p>
    </header>

    <main class="markdown-body">
      <!-- ---------------------------------------- -->
      <p>ある処理を「関数」としてひとつにまとめることで、同じ処理を何度も再利用することができます。関数の使い方をマスターすれば、少ない労力で分かりやすいプログラムを書く事ができます。</p>
      <h1 data-number="1" id="もくじ"><span
      class="header-section-number">1</span> もくじ</h1>
      <ul>
      <li><a href="basic08.html#関数とは">関数とは</a></li>
      <li><a href="basic08.html#関数と引数">関数と引数</a></li>
      <li><a href="basic08.html#関数と戻り値">関数と戻り値</a></li>
      <li><a
      href="basic08.html#ローカル変数とグローバル変数">ローカル変数とグローバル変数</a></li>
      </ul>
      <h1 data-number="2" id="関数とは"><span
      class="header-section-number">2</span> 関数とは</h1>
      <p><code>関数</code>の構造を見ていきましょう。</p>
      <div class="sourceCode" id="cb1" data-caption="関数の構造"><pre
      class="sourceCode numberSource python numberLines"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">def</span> lv_up():</span>
<span id="cb1-2"><a href="#cb1-2"></a>  lv <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>  <span class="bu">print</span>(<span class="st">&quot;レベルが上がった！！&quot;</span>)</span></code></pre></div>
      <p><code>1行目</code>の<code>lv_up</code>の部分を<strong>関数名</strong>といい、好きに名前をつけることができます。
      <code>2～3行目</code>のように、複数の処理を実行するにはそれらの行を<strong>インデント</strong>(<a
      href="basic04.html#インデント">参照</a>)する必要があります。</p>
      <p>ここで注意する必要があるのは、上のコードは<strong>あくまで関数を定義しただけ</strong>ということです。先ほどのコードを実行してみてください。<strong>レベルが上がった！！」とは出力されません。</strong></p>
      <p>定義した関数を実行するには、関数を呼び出す必要があります。次のプログラムをコピー＆ペーストして実行してみてください。</p>
      <div class="sourceCode" id="cb2" data-caption="関数の実行"><pre
      class="sourceCode numberSource python numberLines"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">def</span> lv_up():</span>
<span id="cb2-2"><a href="#cb2-2"></a>  lv <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="bu">print</span>(<span class="st">&quot;レベルが上がった！！&quot;</span>)</span>
<span id="cb2-4"><a href="#cb2-4"></a>lv_up()</span></code></pre></div>
      <p><strong><i class="fa-solid fa-terminal"></i>
      実行結果</strong></p>
      <pre><code>レベルが上がった！！</code></pre>
      <h1 data-number="3" id="関数と引数"><span
      class="header-section-number">3</span> 関数と引数</h1>
      <p>関数には<strong>引数（ひきすう）</strong>という値を与えることができます。次のプログラムを実行してみてください。</p>
      <div class="sourceCode" id="cb4" data-caption="関数と引数"><pre
      class="sourceCode numberSource python numberLines"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">def</span> lv_up(name):</span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="bu">print</span>(name<span class="op">+</span><span class="st">&quot;のレベルが上がった！！&quot;</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a>lv_up(<span class="st">&quot;勇者&quot;</span>)</span>
<span id="cb4-5"><a href="#cb4-5"></a>lv_up(<span class="st">&quot;賢者&quot;</span>)</span></code></pre></div>
      <p><strong><i class="fa-solid fa-terminal"></i>
      実行結果</strong></p>
      <pre><code>勇者のレベルが上がった！！
賢者のレベルが上がった！！</code></pre>
      <p>引数を複数指定することもできます。<code>,(カンマ)</code>を用いて記述します。</p>
      <div class="sourceCode" id="cb6"
      data-caption="複数の引数はカンマで区切る"><pre
      class="sourceCode numberSource python numberLines"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">def</span> division(a,b):</span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="bu">print</span>(<span class="bu">str</span>(a)<span class="op">+</span><span class="st">&quot;÷&quot;</span><span class="op">+</span><span class="bu">str</span>(b)<span class="op">+</span><span class="st">&quot;=&quot;</span><span class="op">+</span><span class="bu">str</span>(a<span class="op">//</span>b)<span class="op">+</span><span class="st">&quot;あまり&quot;</span><span class="op">+</span><span class="bu">str</span>(a<span class="op">%</span>b))</span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a>division(<span class="dv">13</span>,<span class="dv">3</span>)</span></code></pre></div>
      <p><strong><i class="fa-solid fa-terminal"></i>
      実行結果</strong></p>
      <pre><code>13÷3=4あまり1</code></pre>
      <p>このように、引数を用いることで同じような処理をひとまとめにできます。</p>
      <h1 data-number="4" id="関数と戻り値"><span
      class="header-section-number">4</span> 関数と戻り値</h1>
      <p>引数は関数に値を与えることができますが、逆に関数から値を受け取ることもできます。それが<strong>戻り値</strong>です。</p>
      <div class="sourceCode" id="cb8" data-caption="関数と引数"><pre
      class="sourceCode numberSource python numberLines"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">def</span> add(a,b):</span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="cf">return</span> a<span class="op">+</span>b</span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="bu">print</span>(add(<span class="dv">5</span>,<span class="dv">6</span>))</span></code></pre></div>
      <p><strong><i class="fa-solid fa-terminal"></i>
      実行結果</strong></p>
      <pre><code>11</code></pre>
      <p>少し難しいですが、プログラムを見ながら動作を確認しましょう。</p>
      <ul>
      <li>実行すると、1～2行目は関数の<strong>定義なので</strong>何も処理が行われません。</li>
      <li>3行目のprint文の中身にある<strong>add(5,6)</strong>によって、関数が呼び出されます。</li>
      <li>a=5,b=6として関数の中で処理が行われ、戻り値として<code>11</code>が出力されます。</li>
      <li>print文の中身が<code>11</code>になるので、<code>11</code>が表示されます。</li>
      </ul>
      <h1 data-number="5" id="ローカル変数とグローバル変数"><span
      class="header-section-number">5</span>
      ローカル変数とグローバル変数</h1>
      <h2 data-number="5.1" id="ローカル変数"><span
      class="header-section-number">5.1</span> ローカル変数</h2>
      <p>ブロック(インデントされているまとまり)の中で宣言した変数は、他のブロックでは使えません。以下のコードを実行すると<strong>エラー</strong>になります。</p>
      <div class="sourceCode" id="cb10" data-caption="ローカル変数"><pre
      class="sourceCode numberSource python numberLines"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">def</span> add(a,b):</span>
<span id="cb10-2"><a href="#cb10-2"></a>    result <span class="op">=</span> a <span class="op">+</span> b</span>
<span id="cb10-3"><a href="#cb10-3"></a></span>
<span id="cb10-4"><a href="#cb10-4"></a>add(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="bu">print</span>(result)</span></code></pre></div>
      <figure>
      <img src="figs/08/local.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>関数の中で変数<code>result</code>を定義しているので、関数の外で変数を参照しようとするとエラーになります。このように、関数の中定義され、関数の中でしか使えない変数のことを<strong>ローカル変数</strong>といいます。</p>
      <h2 data-number="5.2" id="グローバル変数"><span
      class="header-section-number">5.2</span> グローバル変数</h2>
      <p>この問題を解決するには<code>result</code>をグローバル変数にする必要があります。つまり、<code>result</code>を関数の外で定義すればよいわけです。しかし、ただ関数の外で宣言すればうまくいくかというと、そうではありません。</p>
      <div class="sourceCode" id="cb11"
      data-caption="グローバル変数（失敗例）"><pre
      class="sourceCode numberSource python numberLines"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>result <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="kw">def</span> add(a,b):</span>
<span id="cb11-3"><a href="#cb11-3"></a>    result <span class="op">=</span> a <span class="op">+</span> b</span>
<span id="cb11-4"><a href="#cb11-4"></a></span>
<span id="cb11-5"><a href="#cb11-5"></a>add(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="bu">print</span>(result)</span></code></pre></div>
      <p><strong><i class="fa-solid fa-terminal"></i>
      実行結果</strong></p>
      <pre><code>0</code></pre>
      <p>この場合でも、関数の中の<code>result</code>と、関数の外の<code>result</code>は違うものだとみなされてしまいます。関数の中の<code>result</code>がグローバル変数であることを明記しなけれまなりません。n個のグローバル変数を利用したいとき、関数の初めに以下の形式で記述します。</p>
      <div class="sourceCode" id="cb13"><pre
      class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> 変数名<span class="dv">1</span>,変数名<span class="dv">2</span>,...,変数名n</span></code></pre></div>
      <p>これを用れば、うまく変数の中身を受け渡せるようになります。</p>
      <div class="sourceCode" id="cb14"
      data-caption="グローバル変数（失敗例）"><pre
      class="sourceCode numberSource python numberLines"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a>result <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="kw">def</span> add(a,b):</span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="kw">global</span> result</span>
<span id="cb14-4"><a href="#cb14-4"></a>    result <span class="op">=</span> a <span class="op">+</span> b</span>
<span id="cb14-5"><a href="#cb14-5"></a></span>
<span id="cb14-6"><a href="#cb14-6"></a>add(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="bu">print</span>(result)</span></code></pre></div>
      <p><strong><i class="fa-solid fa-terminal"></i>
      実行結果</strong></p>
      <pre><code>3</code></pre>
      <!-- ---------------------------------------- -->
    </main>

    <footer class="markdown-body">
      <p><a href="https://k-768.github.io/PythonGameProgramming/">講義資料のIndexに移動</a></p>
    </footer>

    <script>
      window.onload = function () {
        // ナビゲーション関連
        let openBtn = document.getElementsByClassName("openbtn")[0];
        let navPnl = document.getElementById("g-nav");
        openBtn.onclick = () => {
          openBtn.classList.toggle("active");
          navPnl.classList.toggle("panelactive");
        };

        let items = navPnl.getElementsByTagName("a");
        Array.from(items).forEach((item) => {
          item.onclick = () => {
            openBtn.classList.toggle("active");
            navPnl.classList.toggle("panelactive");
          };
        });

        // マスク処理
        let maskedSpans = document.getElementsByClassName("masked");
        Array.from(maskedSpans).forEach((span) => {
          span.onclick = () => {
            span.classList.toggle("open");
          };
        });

        // data-startfrom 属性の行番号カウンタのリセット
        document.querySelectorAll("div.sourceCode").forEach(function (div) {
          var startFrom = div.getAttribute("data-startfrom");
          if (startFrom != null) {
            div.style.counterReset = "pg-line " + (startFrom - 1);
          }
        });

        // 画像にリンクを付与
        // let images = document.querySelectorAll("figure img");
        // Array.from(images).forEach((img) => {
        //   img.onclick = () => {
        //     location.href = img.getAttribute("src");
        //   };
        // });
      };
    </script>
  </body>
</html>
