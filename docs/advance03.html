<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />
    <meta name="robots" content="noindex,nofollow,noarchive" />

    <script>
      MathJax = {
        chtml: {
          displayAlign: "left",
          displayIndent: "1em",
        },
      };
    </script>

    

    <link rel="icon" href="favicon2.ico" sizes="any" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
      integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=M+PLUS+Rounded+1c"
    />
    <link rel="stylesheet" href="style.css" />

    <title>ゲームづくり編3　マップを表示しよう</title>
  </head>

  <body>
    <div class="openbtn"><span></span><span></span><span></span></div>
    <nav id="g-nav">
      <div id="g-nav-list">
        <!-- ---------------------------------------- -->
         <ul>
<li><a href="#ゲームのマップ" id="toc-ゲームのマップ"><span
class="toc-section-number">1</span> ゲームのマップ</a></li>
<li><a href="#もくじ" id="toc-もくじ"><span
class="toc-section-number">2</span> もくじ</a></li>
<li><a href="#マップチップとは" id="toc-マップチップとは"><span
class="toc-section-number">3</span> マップチップとは</a></li>
<li><a href="#tkinterでウィンドウを表示する"
id="toc-tkinterでウィンドウを表示する"><span
class="toc-section-number">4</span>
Tkinterでウィンドウを表示する</a></li>
<li><a href="#マップチップを表示する"
id="toc-マップチップを表示する"><span
class="toc-section-number">5</span> マップチップを表示する</a></li>
<li><a href="#枚の画像からマップチップを取得する"
id="toc-枚の画像からマップチップを取得する"><span
class="toc-section-number">6</span>
1枚の画像からマップチップを取得する</a></li>
<li><a href="#データをもとにマップを配置する"
id="toc-データをもとにマップを配置する"><span
class="toc-section-number">7</span>
データをもとにマップを配置する</a></li>
<li><a href="#さらに豪華なマップを作ろう"
id="toc-さらに豪華なマップを作ろう"><span
class="toc-section-number">8</span> さらに豪華なマップを作ろう</a></li>
</ul> 
        <!-- ---------------------------------------- -->
      </div>
    </nav>

    <header class="markdown-body">
      <p>Pythonで釣りゲームを作ろう
ゲームづくり編3　マップを表示しよう</p>
      <p>2024年12月6日（金）</p>
    </header>

    <main class="markdown-body">
      <!-- ---------------------------------------- -->
      <h1 data-number="1" id="ゲームのマップ"><span
      class="header-section-number">1</span> ゲームのマップ</h1>
      <p>マップ画面は、RPG（ロールプレイングゲーム）やシミュレーションゲームなど、多くのゲームで欠かせない要素です。今回は、<strong>マップチップ</strong>と呼ばれるものを使って、マップを描写してみましょう。</p>
      <p><br></p>
      <h1 data-number="2" id="もくじ"><span
      class="header-section-number">2</span> もくじ</h1>
      <ul>
      <li><a href="advance03.html#"></a></li>
      </ul>
      <p><br></p>
      <h1 data-number="3" id="マップチップとは"><span
      class="header-section-number">3</span> マップチップとは</h1>
      <p>ゲームには、プレイヤーが探索するフィールド、都市、ダンジョンなど、さまざまな場所が登場します。しかし、一枚一枚のマップを手作業で描いていくとなると、膨大な時間と労力が必要になります。そこで登場するのが<strong>マップチップ</strong>です。マップチップとは、草地や水辺、道路など、<strong>地形やオブジェクト(チェストやタンスなどの「もの」)を表す小さな画像パーツ</strong>のことです。これらを組み合わせることで、効率的にマップを構築することができます。</p>
      <p>画像の用意や処理がシンプルなため、容量制限の厳しかった昔はほとんどのゲームでマップチップが採用されていました。マップチップを用いれば、初心者でも簡単に取り組めます。</p>
      <p><br></p>
      <p>今回は、<code>grass.png</code> <code>sand.png</code>
      <code>water.png</code>の3枚の画像を用います。ダウンロードして<code>img</code>フォルダに入れておいてください。</p>
      <p><img src="./figs/103/grass.png" alt="img" /><img
      src="./figs/103/sand.png" alt="img" /><img
      src="./figs/103/water.png" alt="img" /></p>
      <p>これらの画像は、基本的に同じサイズでそろえることをおすすめします。今回は<code>64x64px</code>で統一しています。</p>
      <h1 data-number="4" id="tkinterでウィンドウを表示する"><span
      class="header-section-number">4</span>
      Tkinterでウィンドウを表示する</h1>
      <p>新しいファイル<code>map01.py</code>を作成して、ウィンドウを表示するプログラムを制作していきましょう。</p>
      <div class="sourceCode" id="cb1" data-startFrom="1"
      data-caption="map01.py"><pre
      class="sourceCode numberSource python numberLines"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> os</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> tkinter <span class="im">as</span> tk</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">#&gt;&gt;ディレクトリ&gt;&gt;</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>cwd <span class="op">=</span> os.getcwd()</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">#&gt;&gt;マップ設定&gt;&gt;</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>CHIP_SIZE <span class="op">=</span> <span class="dv">64</span> <span class="co">#マップチップの大きさ</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>X_MAPSIZE <span class="op">=</span> <span class="dv">20</span> <span class="co">#マップのx方向タイル数</span></span>
<span id="cb1-10"><a href="#cb1-10"></a>Y_MAPSIZE <span class="op">=</span> <span class="dv">10</span> <span class="co">#マップのy方向タイル数</span></span>
<span id="cb1-11"><a href="#cb1-11"></a></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co">#&gt;&gt;ウィンドウ、キャンバス&gt;&gt;</span></span>
<span id="cb1-13"><a href="#cb1-13"></a>CANVAS_WIDTH <span class="op">=</span> CHIP_SIZE <span class="op">*</span> X_MAPSIZE <span class="co">#キャンバス幅</span></span>
<span id="cb1-14"><a href="#cb1-14"></a>CANVAS_HEIGHT <span class="op">=</span> CHIP_SIZE <span class="op">*</span> Y_MAPSIZE <span class="co">#キャンバス高さ</span></span>
<span id="cb1-15"><a href="#cb1-15"></a>MARGINE_X <span class="op">=</span> <span class="dv">2</span> <span class="co">#マージン</span></span>
<span id="cb1-16"><a href="#cb1-16"></a>MARGINE_Y <span class="op">=</span> <span class="dv">2</span> <span class="co">#マージン</span></span>
<span id="cb1-17"><a href="#cb1-17"></a>CANVAS_SIZE <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>CANVAS_WIDTH<span class="op">+</span>MARGINE_X<span class="sc">}</span><span class="ss">x</span><span class="sc">{</span>CANVAS_HEIGHT<span class="op">+</span>MARGINE_Y<span class="sc">}</span><span class="ss">&quot;</span><span class="co">#キャンバスサイズ</span></span>
<span id="cb1-18"><a href="#cb1-18"></a></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="co">#ウィンドウ設置</span></span>
<span id="cb1-20"><a href="#cb1-20"></a>root <span class="op">=</span> tk.Tk()</span>
<span id="cb1-21"><a href="#cb1-21"></a>root.title(<span class="st">&quot;マップ表示&quot;</span>)</span>
<span id="cb1-22"><a href="#cb1-22"></a>root.geometry(CANVAS_SIZE)</span>
<span id="cb1-23"><a href="#cb1-23"></a></span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="co">#キャンバス設置</span></span>
<span id="cb1-25"><a href="#cb1-25"></a>canvas <span class="op">=</span> tk.Canvas(root,width <span class="op">=</span> CANVAS_WIDTH,height <span class="op">=</span> CANVAS_HEIGHT,bg <span class="op">=</span> <span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb1-26"><a href="#cb1-26"></a>canvas.pack()</span>
<span id="cb1-27"><a href="#cb1-27"></a></span>
<span id="cb1-28"><a href="#cb1-28"></a></span>
<span id="cb1-29"><a href="#cb1-29"></a><span class="co">#&gt;&gt;マップチップ&gt;&gt;</span></span>
<span id="cb1-30"><a href="#cb1-30"></a>MAP_CHIP <span class="op">=</span> [</span>
<span id="cb1-31"><a href="#cb1-31"></a>    tk.PhotoImage(<span class="bu">file</span> <span class="op">=</span> cwd<span class="op">+</span><span class="st">&quot;/img/grass.png&quot;</span>),</span>
<span id="cb1-32"><a href="#cb1-32"></a>    tk.PhotoImage(<span class="bu">file</span> <span class="op">=</span> cwd<span class="op">+</span><span class="st">&quot;/img/sand.png&quot;</span>),</span>
<span id="cb1-33"><a href="#cb1-33"></a>    tk.PhotoImage(<span class="bu">file</span> <span class="op">=</span> cwd<span class="op">+</span><span class="st">&quot;/img/water.png&quot;</span>)</span>
<span id="cb1-34"><a href="#cb1-34"></a>    ]</span>
<span id="cb1-35"><a href="#cb1-35"></a></span>
<span id="cb1-36"><a href="#cb1-36"></a>root.mainloop()</span></code></pre></div>
      <p>最初の方で多くの数字を設定しています。マップチップの大きさや、マップのサイズなどです。このように、様々な値を変数で置いておくことで、あとからの修正が楽になります。</p>
      <p>そして、用意した画像は最後の方で<strong>リスト</strong>に格納されています。</p>
      <hr />
      <ul>
      <li><strong>ChallengeA3-1</strong>　草の画像を呼び出したいとき、どのように記述したら良いですか。</li>
      </ul>
      <p><strong><i class="fa-solid fa-check"></i>解答</strong></p>
      <p><span class="masked"><code>MAP_CHIP[0]</code></span></p>
      <h1 data-number="5" id="マップチップを表示する"><span
      class="header-section-number">5</span> マップチップを表示する</h1>
      <p>以下の一文を<code>root.mainloop()</code>の前に追加してみてください。</p>
      <div class="sourceCode" id="cb2" data-startFrom="36"
      data-caption="map01.py（続き）"><pre
      class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 35;"><span id="cb2-36"><a href="#cb2-36"></a>canvas.create_image(<span class="dv">0</span>,<span class="dv">0</span>,image <span class="op">=</span>MAP_CHIP[<span class="dv">0</span>] ,tag<span class="op">=</span><span class="st">&quot;chip1&quot;</span>,anchor<span class="op">=</span>tk.NW)</span></code></pre></div>
      <p>実行すると、マップチップが表示されます。</p>
      <figure>
      <img src="./figs/103/putGrass.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p><br></p>
      <p>これを並べていけばマップが作れます。一つ右に砂地を配置してみましょう。</p>
      <div class="sourceCode" id="cb3" data-startFrom="37"
      data-caption="map01.py（続き）"><pre
      class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 36;"><span id="cb3-37"><a href="#cb3-37"></a>canvas.create_image(CHIP_SIZE,<span class="dv">0</span>,image <span class="op">=</span>MAP_CHIP[<span class="dv">1</span>] ,tag<span class="op">=</span><span class="st">&quot;chip2&quot;</span>,anchor<span class="op">=</span>tk.NW)</span></code></pre></div>
      <p>これを繰り返し行えばよいので、繰り返し文を用いてみましょう。<strong>先ほどの画像を配置する2文を消して、以下のプログラムを追加してください。</strong></p>
      <div class="sourceCode" id="cb4" data-startFrom="36"
      data-caption="map01.py（続き）"><pre
      class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 35;"><span id="cb4-36"><a href="#cb4-36"></a><span class="cf">for</span> y <span class="kw">in</span> <span class="bu">range</span>(Y_MAPSIZE):</span>
<span id="cb4-37"><a href="#cb4-37"></a>    <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(X_MAPSIZE):</span>
<span id="cb4-38"><a href="#cb4-38"></a>        canvas.create_image(x<span class="op">*</span>CHIP_SIZE,y<span class="op">*</span>CHIP_SIZE,image <span class="op">=</span>MAP_CHIP[<span class="dv">0</span>] ,tag<span class="op">=</span><span class="ss">f&quot;chip</span><span class="sc">{</span>x<span class="sc">}</span><span class="ss">,</span><span class="sc">{</span>y<span class="sc">}</span><span class="ss">&quot;</span>,anchor<span class="op">=</span>tk.NW)</span></code></pre></div>
      <p>ウィンドウが草地で埋め尽くされたら成功です。</p>
      <figure>
      <img src="./figs/103/allgreen.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p><br></p>
      <h1 data-number="6" id="枚の画像からマップチップを取得する"><span
      class="header-section-number">6</span>
      1枚の画像からマップチップを取得する</h1>
      <p>今回はマップチップは3種類しかありませんが、これが50種類、100種類と増えてくると画像の管理が大変になります。そこで、通常は<strong>マップチップを並べた画像1枚</strong>を分割して利用します。</p>
      <p>以下の画像をダウンロードして<code>sheet1.png</code>という名前で<code>img</code>フォルダに入れておいてください。</p>
      <figure>
      <img src="./figs/103/sheet1.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <div class="sourceCode" id="cb5" data-startFrom="1"
      data-caption="map02.py"><pre
      class="sourceCode numberSource python numberLines"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="im">import</span> os</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="im">import</span> tkinter <span class="im">as</span> tk</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="im">from</span> PIL <span class="im">import</span> Image,ImageTk</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#&gt;&gt;ディレクトリ&gt;&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>cwd <span class="op">=</span> os.getcwd()</span>
<span id="cb5-7"><a href="#cb5-7"></a></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">#&gt;&gt;マップ設定&gt;&gt;</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>CHIP_SIZE <span class="op">=</span> <span class="dv">64</span> <span class="co">#マップチップの大きさ</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>X_MAPSIZE <span class="op">=</span> <span class="dv">20</span> <span class="co">#マップのx方向タイル数</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>Y_MAPSIZE <span class="op">=</span> <span class="dv">10</span> <span class="co">#マップのy方向タイル数</span></span>
<span id="cb5-12"><a href="#cb5-12"></a></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co">#&gt;&gt;ウィンドウ、キャンバス&gt;&gt;</span></span>
<span id="cb5-14"><a href="#cb5-14"></a>CANVAS_WIDTH <span class="op">=</span> CHIP_SIZE <span class="op">*</span> X_MAPSIZE <span class="co">#キャンバス幅</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>CANVAS_HEIGHT <span class="op">=</span> CHIP_SIZE <span class="op">*</span> Y_MAPSIZE <span class="co">#キャンバス高さ</span></span>
<span id="cb5-16"><a href="#cb5-16"></a>MARGINE_X <span class="op">=</span> <span class="dv">2</span> <span class="co">#マージン</span></span>
<span id="cb5-17"><a href="#cb5-17"></a>MARGINE_Y <span class="op">=</span> <span class="dv">2</span> <span class="co">#マージン</span></span>
<span id="cb5-18"><a href="#cb5-18"></a>CANVAS_SIZE <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>CANVAS_WIDTH<span class="op">+</span>MARGINE_X<span class="sc">}</span><span class="ss">x</span><span class="sc">{</span>CANVAS_HEIGHT<span class="op">+</span>MARGINE_Y<span class="sc">}</span><span class="ss">&quot;</span><span class="co">#キャンバスサイズ</span></span>
<span id="cb5-19"><a href="#cb5-19"></a></span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="co">#ウィンドウ設置</span></span>
<span id="cb5-21"><a href="#cb5-21"></a>root <span class="op">=</span> tk.Tk()</span>
<span id="cb5-22"><a href="#cb5-22"></a>root.title(<span class="st">&quot;マップ表示&quot;</span>)</span>
<span id="cb5-23"><a href="#cb5-23"></a>root.geometry(CANVAS_SIZE)</span>
<span id="cb5-24"><a href="#cb5-24"></a></span>
<span id="cb5-25"><a href="#cb5-25"></a><span class="co">#キャンバス設置</span></span>
<span id="cb5-26"><a href="#cb5-26"></a>canvas <span class="op">=</span> tk.Canvas(root,width <span class="op">=</span> CANVAS_WIDTH,height <span class="op">=</span> CANVAS_HEIGHT,bg <span class="op">=</span> <span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb5-27"><a href="#cb5-27"></a>canvas.pack()</span>
<span id="cb5-28"><a href="#cb5-28"></a></span>
<span id="cb5-29"><a href="#cb5-29"></a></span>
<span id="cb5-30"><a href="#cb5-30"></a><span class="co">#&gt;&gt;マップチップ&gt;&gt;</span></span>
<span id="cb5-31"><a href="#cb5-31"></a><span class="co">#マップチップを1枚の画像に並べたマップシートを読み込む</span></span>
<span id="cb5-32"><a href="#cb5-32"></a>MAP_SHEET <span class="op">=</span> Image.<span class="bu">open</span>(cwd<span class="op">+</span><span class="st">&quot;/img/sheet1.png&quot;</span>)</span>
<span id="cb5-33"><a href="#cb5-33"></a></span>
<span id="cb5-34"><a href="#cb5-34"></a><span class="co">#読み込んだ画像から縦横何枚ずつチップがあるか求める</span></span>
<span id="cb5-35"><a href="#cb5-35"></a>CHIP_X <span class="op">=</span> MAP_SHEET.width <span class="op">//</span> CHIP_SIZE</span>
<span id="cb5-36"><a href="#cb5-36"></a>CHIP_Y <span class="op">=</span> MAP_SHEET.height <span class="op">//</span> CHIP_SIZE</span>
<span id="cb5-37"><a href="#cb5-37"></a></span>
<span id="cb5-38"><a href="#cb5-38"></a><span class="co">#マップシートをマップチップに分割し配列に格納する</span></span>
<span id="cb5-39"><a href="#cb5-39"></a>MAP_CHIP <span class="op">=</span> []</span>
<span id="cb5-40"><a href="#cb5-40"></a></span>
<span id="cb5-41"><a href="#cb5-41"></a><span class="cf">for</span> y <span class="kw">in</span> <span class="bu">range</span>(CHIP_Y):</span>
<span id="cb5-42"><a href="#cb5-42"></a>    <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(CHIP_X):</span>
<span id="cb5-43"><a href="#cb5-43"></a>        image <span class="op">=</span> ImageTk.PhotoImage(MAP_SHEET.crop((</span>
<span id="cb5-44"><a href="#cb5-44"></a>            CHIP_SIZE<span class="op">*</span>x , </span>
<span id="cb5-45"><a href="#cb5-45"></a>            CHIP_SIZE<span class="op">*</span>y , </span>
<span id="cb5-46"><a href="#cb5-46"></a>            CHIP_SIZE<span class="op">*</span>(x<span class="op">+</span><span class="dv">1</span>) , </span>
<span id="cb5-47"><a href="#cb5-47"></a>            CHIP_SIZE<span class="op">*</span>(y<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb5-48"><a href="#cb5-48"></a>            )))</span>
<span id="cb5-49"><a href="#cb5-49"></a>        MAP_CHIP.append(image)</span>
<span id="cb5-50"><a href="#cb5-50"></a></span>
<span id="cb5-51"><a href="#cb5-51"></a><span class="cf">for</span> y <span class="kw">in</span> <span class="bu">range</span>(Y_MAPSIZE):</span>
<span id="cb5-52"><a href="#cb5-52"></a>    <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(X_MAPSIZE):</span>
<span id="cb5-53"><a href="#cb5-53"></a>        canvas.create_image(x<span class="op">*</span>CHIP_SIZE,y<span class="op">*</span>CHIP_SIZE,image <span class="op">=</span>MAP_CHIP[<span class="dv">1</span>] ,tag<span class="op">=</span><span class="ss">f&quot;chip</span><span class="sc">{</span>x<span class="sc">}</span><span class="ss">,</span><span class="sc">{</span>y<span class="sc">}</span><span class="ss">&quot;</span>,anchor<span class="op">=</span>tk.NW)</span>
<span id="cb5-54"><a href="#cb5-54"></a></span>
<span id="cb5-55"><a href="#cb5-55"></a>root.mainloop()</span></code></pre></div>
      <p>まず、<code>35行目</code>
      <code>36行目</code>で、読み込んだ画像に縦横何枚ずつチップが並べられているか計算しています。</p>
      <p><code>MAP_SHEET.width</code>が読み込んだ画像の幅です。これをマップチップ1枚の幅<code>CHIP_SIZE</code>で割ることで、横に並んでいるマップチップの枚数<code>CHIP_X</code>を求めます。</p>
      <div class="sourceCode" id="cb6" data-startFrom="35"
      data-caption="map02.py（抜粋）"><pre
      class="sourceCode numberSource python numberLines"><code class="sourceCode python" style="counter-reset: source-line 34;"><span id="cb6-35"><a href="#cb6-35"></a>CHIP_X <span class="op">=</span> MAP_SHEET.width <span class="op">//</span> CHIP_SIZE</span></code></pre></div>
      <p><code>41行目</code>からは2重ループを用いてマップチップを1枚1枚切り取り、リストに格納しています。</p>
      <p>これで、マップを表示する仕組みは完成しました。</p>
      <p><br></p>
      <h1 data-number="7" id="データをもとにマップを配置する"><span
      class="header-section-number">7</span>
      データをもとにマップを配置する</h1>
      <p>マップを表示するためのデータは、二次元リストで簡単につくれます。</p>
      <div class="sourceCode" id="cb7"
      data-caption="マップのデータ"><pre
      class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>MAP_DATA <span class="op">=</span> [</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>],</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>],</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>],</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>],</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>],</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>],</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>],</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>],</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>],</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>],</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>]</span></code></pre></div>
      <p>リスト上のそれぞれの数字がマップチップの番号に対応しています。<strong>1と書いてある場所には草地が</strong>、<strong>2と書いてある場所には砂地が</strong>配置されます。</p>
      <hr />
      <ul>
      <li><strong>ChallengeA3-2</strong>　以下のプログラムの<code>69行目</code>を改造して、データをもとにマップが表示されるようにしましょう。</li>
      </ul>
      <p>ヒント：以下のプログラムでは、<code>img = MAP_CHIP[1]</code>となっているので全て草地が配置されます。この<code>1</code>をマップのデータに変えれば、配置される画像も場所によって変わるようになります。</p>
      <p>答えを確認する前に、<strong>MAP_DATAのいちばん左上を1→3に変えて実行してみてください。</strong>表示されたマップの左上が水に代わっていればOKです。</p>
      <div class="sourceCode" id="cb8" data-startFrom="1"
      data-caption="map03.py"><pre
      class="sourceCode numberSource python numberLines"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="im">import</span> os</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="im">import</span> tkinter <span class="im">as</span> tk</span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="im">from</span> PIL <span class="im">import</span> Image,ImageTk</span>
<span id="cb8-4"><a href="#cb8-4"></a></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">#&gt;&gt;ディレクトリ&gt;&gt;</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>cwd <span class="op">=</span> os.getcwd()</span>
<span id="cb8-7"><a href="#cb8-7"></a></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">#&gt;&gt;マップ設定&gt;&gt;</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>CHIP_SIZE <span class="op">=</span> <span class="dv">64</span> <span class="co">#マップチップの大きさ</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>X_MAPSIZE <span class="op">=</span> <span class="dv">20</span> <span class="co">#マップのx方向タイル数</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>Y_MAPSIZE <span class="op">=</span> <span class="dv">10</span> <span class="co">#マップのy方向タイル数</span></span>
<span id="cb8-12"><a href="#cb8-12"></a></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co">#&gt;&gt;ウィンドウ、キャンバス&gt;&gt;</span></span>
<span id="cb8-14"><a href="#cb8-14"></a>CANVAS_WIDTH <span class="op">=</span> CHIP_SIZE <span class="op">*</span> X_MAPSIZE <span class="co">#キャンバス幅</span></span>
<span id="cb8-15"><a href="#cb8-15"></a>CANVAS_HEIGHT <span class="op">=</span> CHIP_SIZE <span class="op">*</span> Y_MAPSIZE <span class="co">#キャンバス高さ</span></span>
<span id="cb8-16"><a href="#cb8-16"></a>MARGINE_X <span class="op">=</span> <span class="dv">2</span> <span class="co">#マージン</span></span>
<span id="cb8-17"><a href="#cb8-17"></a>MARGINE_Y <span class="op">=</span> <span class="dv">2</span> <span class="co">#マージン</span></span>
<span id="cb8-18"><a href="#cb8-18"></a>CANVAS_SIZE <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>CANVAS_WIDTH<span class="op">+</span>MARGINE_X<span class="sc">}</span><span class="ss">x</span><span class="sc">{</span>CANVAS_HEIGHT<span class="op">+</span>MARGINE_Y<span class="sc">}</span><span class="ss">&quot;</span><span class="co">#キャンバスサイズ</span></span>
<span id="cb8-19"><a href="#cb8-19"></a></span>
<span id="cb8-20"><a href="#cb8-20"></a><span class="co">#ウィンドウ設置</span></span>
<span id="cb8-21"><a href="#cb8-21"></a>root <span class="op">=</span> tk.Tk()</span>
<span id="cb8-22"><a href="#cb8-22"></a>root.title(<span class="st">&quot;マップ表示&quot;</span>)</span>
<span id="cb8-23"><a href="#cb8-23"></a>root.geometry(CANVAS_SIZE)</span>
<span id="cb8-24"><a href="#cb8-24"></a></span>
<span id="cb8-25"><a href="#cb8-25"></a><span class="co">#キャンバス設置</span></span>
<span id="cb8-26"><a href="#cb8-26"></a>canvas <span class="op">=</span> tk.Canvas(root,width <span class="op">=</span> CANVAS_WIDTH,height <span class="op">=</span> CANVAS_HEIGHT,bg <span class="op">=</span> <span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb8-27"><a href="#cb8-27"></a>canvas.pack()</span>
<span id="cb8-28"><a href="#cb8-28"></a></span>
<span id="cb8-29"><a href="#cb8-29"></a></span>
<span id="cb8-30"><a href="#cb8-30"></a><span class="co">#&gt;&gt;マップチップ&gt;&gt;</span></span>
<span id="cb8-31"><a href="#cb8-31"></a><span class="co">#マップチップを1枚の画像に並べたマップシートを読み込む</span></span>
<span id="cb8-32"><a href="#cb8-32"></a>MAP_SHEET <span class="op">=</span> Image.<span class="bu">open</span>(cwd<span class="op">+</span><span class="st">&quot;/img/sheet1.png&quot;</span>)</span>
<span id="cb8-33"><a href="#cb8-33"></a></span>
<span id="cb8-34"><a href="#cb8-34"></a><span class="co">#読み込んだ画像から縦横何枚ずつチップがあるか求める</span></span>
<span id="cb8-35"><a href="#cb8-35"></a>CHIP_X <span class="op">=</span> MAP_SHEET.width <span class="op">//</span> CHIP_SIZE</span>
<span id="cb8-36"><a href="#cb8-36"></a>CHIP_Y <span class="op">=</span> MAP_SHEET.height <span class="op">//</span> CHIP_SIZE</span>
<span id="cb8-37"><a href="#cb8-37"></a></span>
<span id="cb8-38"><a href="#cb8-38"></a><span class="co">#マップシートをマップチップに分割し配列に格納する</span></span>
<span id="cb8-39"><a href="#cb8-39"></a>MAP_CHIP <span class="op">=</span> []</span>
<span id="cb8-40"><a href="#cb8-40"></a></span>
<span id="cb8-41"><a href="#cb8-41"></a><span class="cf">for</span> y <span class="kw">in</span> <span class="bu">range</span>(CHIP_Y):</span>
<span id="cb8-42"><a href="#cb8-42"></a>    <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(CHIP_X):</span>
<span id="cb8-43"><a href="#cb8-43"></a>        image <span class="op">=</span> ImageTk.PhotoImage(MAP_SHEET.crop((</span>
<span id="cb8-44"><a href="#cb8-44"></a>            CHIP_SIZE<span class="op">*</span>x , </span>
<span id="cb8-45"><a href="#cb8-45"></a>            CHIP_SIZE<span class="op">*</span>y , </span>
<span id="cb8-46"><a href="#cb8-46"></a>            CHIP_SIZE<span class="op">*</span>(x<span class="op">+</span><span class="dv">1</span>) , </span>
<span id="cb8-47"><a href="#cb8-47"></a>            CHIP_SIZE<span class="op">*</span>(y<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb8-48"><a href="#cb8-48"></a>            )))</span>
<span id="cb8-49"><a href="#cb8-49"></a>        MAP_CHIP.append(image)</span>
<span id="cb8-50"><a href="#cb8-50"></a></span>
<span id="cb8-51"><a href="#cb8-51"></a></span>
<span id="cb8-52"><a href="#cb8-52"></a><span class="co">#&gt;&gt;マップデータ&gt;&gt;</span></span>
<span id="cb8-53"><a href="#cb8-53"></a>MAP_DATA <span class="op">=</span> [</span>
<span id="cb8-54"><a href="#cb8-54"></a>    [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>],</span>
<span id="cb8-55"><a href="#cb8-55"></a>    [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>],</span>
<span id="cb8-56"><a href="#cb8-56"></a>    [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>],</span>
<span id="cb8-57"><a href="#cb8-57"></a>    [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>],</span>
<span id="cb8-58"><a href="#cb8-58"></a>    [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>],</span>
<span id="cb8-59"><a href="#cb8-59"></a>    [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>],</span>
<span id="cb8-60"><a href="#cb8-60"></a>    [<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>],</span>
<span id="cb8-61"><a href="#cb8-61"></a>    [<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>],</span>
<span id="cb8-62"><a href="#cb8-62"></a>    [<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>],</span>
<span id="cb8-63"><a href="#cb8-63"></a>    [<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>],</span>
<span id="cb8-64"><a href="#cb8-64"></a>]</span>
<span id="cb8-65"><a href="#cb8-65"></a></span>
<span id="cb8-66"><a href="#cb8-66"></a></span>
<span id="cb8-67"><a href="#cb8-67"></a><span class="cf">for</span> y <span class="kw">in</span> <span class="bu">range</span>(Y_MAPSIZE):</span>
<span id="cb8-68"><a href="#cb8-68"></a>    <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(X_MAPSIZE):</span>
<span id="cb8-69"><a href="#cb8-69"></a>        canvas.create_image(x<span class="op">*</span>CHIP_SIZE,y<span class="op">*</span>CHIP_SIZE,image <span class="op">=</span> MAP_CHIP[<span class="dv">1</span>] ,tag<span class="op">=</span><span class="ss">f&quot;chip</span><span class="sc">{</span>x<span class="sc">}</span><span class="ss">,</span><span class="sc">{</span>y<span class="sc">}</span><span class="ss">&quot;</span>,anchor<span class="op">=</span>tk.NW)</span>
<span id="cb8-70"><a href="#cb8-70"></a></span>
<span id="cb8-71"><a href="#cb8-71"></a>root.mainloop()</span></code></pre></div>
      <p><strong><i class="fa-solid fa-check"></i>解答</strong></p>
      <p><span
      class="masked"><code>image =MAP_CHIP[MAP_DATA[y][x]]</code></span></p>
      <hr />
      <p>これでデータをもとにマップチップを配置することができました！データを変更して、自由にマップを作ってみてください。</p>
      <h1 data-number="8" id="さらに豪華なマップを作ろう"><span
      class="header-section-number">8</span>
      さらに豪華なマップを作ろう</h1>
      <p>「マップチップ　フリー」などで検索すると、マップチップのフリー素材を入手できます。それを活用すればさらに豪華なマップを作れます。
      おすすめのサイトを紹介します。</p>
      <ul>
      <li><a
      href="https://pipoya.net/sozai/assets/map-chip_tileset16/#マップセット１">マップチップ　16×16
      -ぴぽや倉庫</a></li>
      </ul>
      <p>使う際は入手した画像が何px四方なのかよく確認して、プログラムの<code>CHIP_SIZE</code>を変更してください。また、<strong>ゲームを公開したり配布する際は、使用する素材の規約をよく確認してください。</strong>ぜひ、楽しく自分でマップを作りこんでみてください！</p>
      <!-- ---------------------------------------- -->
    </main>

    <footer class="markdown-body">
      <p><a href="https://k-768.github.io/PythonGameProgramming/">講義資料のIndexに移動</a></p>
    </footer>

    <script>
      window.onload = function () {
        // ナビゲーション関連
        let openBtn = document.getElementsByClassName("openbtn")[0];
        let navPnl = document.getElementById("g-nav");
        openBtn.onclick = () => {
          openBtn.classList.toggle("active");
          navPnl.classList.toggle("panelactive");
        };

        let items = navPnl.getElementsByTagName("a");
        Array.from(items).forEach((item) => {
          item.onclick = () => {
            openBtn.classList.toggle("active");
            navPnl.classList.toggle("panelactive");
          };
        });

        // マスク処理
        let maskedSpans = document.getElementsByClassName("masked");
        Array.from(maskedSpans).forEach((span) => {
          span.onclick = () => {
            span.classList.toggle("open");
          };
        });

        // data-startfrom 属性の行番号カウンタのリセット
        document.querySelectorAll("div.sourceCode").forEach(function (div) {
          var startFrom = div.getAttribute("data-startfrom");
          if (startFrom != null) {
            div.style.counterReset = "pg-line " + (startFrom - 1);
          }
        });

        // 画像にリンクを付与
        // let images = document.querySelectorAll("figure img");
        // Array.from(images).forEach((img) => {
        //   img.onclick = () => {
        //     location.href = img.getAttribute("src");
        //   };
        // });
      };
    </script>
  </body>
</html>
